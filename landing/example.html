<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/landing/landingStyles.css">
    <title>Document</title>
</head>
<body>
    <header id="navBar">
        <div id="searchContainer">
            <input type="text" placeholder="Search our Selection" id="userInput">
            <button id="searchButn">Search</button>
            <input type="text" id="commentInp" placeholder="Please Enter your comment">
            <button id="commentBtn">Share</button>
        </div>
    </header>
    
  

    <main>
        <aside>
            <h1>Favorites</h1>
        </aside>
        <div id="results"></div>
<!---button moved here--->

        <button type="button" id="favbutton"  >Add to favorite</button>


    </main>
    
    <script>

        var searchBtn = document.getElementById("searchButn");
        var url = "https://www.themealdb.com/api/json/v1/1/search.php?s=";
        var result = document.getElementById('results');


            searchBtn.addEventListener("click", () => {
                var userInp = document.getElementById("userInput").value;
                if (userInp.length == 0){
                    result.innerHTML=`<h3>Please Enter a Valid Name</h3>`
                    
                }else{
                    fetch(url + userInp)
                    .then((res)=> {return res.json()})    
                    .then((data)=>{
                        let meal = data.meals[0];
                        let info = "";       
                    
            
        searchBtn.addEventListener("click", () => {
            var userInp = document.getElementById("userInput").value;
            if (userInp.length == 0){
                result.innerHTML=`<h3>Please Enter a Valid Name</h3>`
            }else{
                fetch(url + userInp)
                .then((res)=> {return res.json()})    
                .then((data)=>{
                    let meal = data.meals[0];
                    let info = "";           
                        info += `

                            <div id="recipeBox"> 
                            <img src=${meal.strMealThumb} alt="photo" class="img" height="200" width="200">
                            <h1 class="title">${meal.strMeal}</h1>
                            <ul>  </ul>
                            <p>${meal.strInstructions}</p>
                            </div> 
                            `
                    result.innerHTML = info;

                        <div id="recipeBox"> 
                        <img src=${meal.strMealThumb} alt="photo" class="img" height="200" width="200">
                        <h1 class="title">${meal.strMeal}</h1>
                        <ul>  </ul>
                        <p>${meal.strInstructions}</p>
                        <button type="button" id="favbutton" >Add to favorite</button>         
                        <div id="button"></div>
                        <div id="inputComment"</div>              
                        <div id="comments">COMMENTS</div>
                       
                        `
                        result.innerHTML = info;

                        // comment input and button place
                        document.getElementById("inputComment").appendChild(commentInp)
                        document.getElementById("button").appendChild(commentBtn)

                    
                    // INGREDIENTS PART
                    let ingredient = []
                    let count = 1
                    let ing = ""
                    let mes = ""
                    for(i in meal){                    
                        if(i.startsWith("strIngredient") && meal[i]){
                        ing = meal[`strIngredient` + count];
                        mes = meal[`strMeasure` + count];
                        count += 1;
                        ingredient.push(`${mes} ${ing}`)
                        console.log(ingredient)                
                    }}            
                    
                    // INGREDIENT LIST PART
                    ingredient.forEach((i)=>{
                        let list = document.createElement("li");
                        list.innerText = i
                        document.querySelector("ul").appendChild(list)
                    })

                    // LOCAL STORAGE

                    var favbutton = document.getElementById('favbutton').addEventListener("click",() =>{
                            window.localStorage.setItem('recipe', meal.strMeal);
                            
                            console.log(data.meals[0]);
                            let recipeTitle = data.meals[0].strMeal;                         
                            console.log(recipeTitle)
                            var values = [];
                            values.push(recipeTitle);
                            console.log(values);
                                // function updateAside(){
                                //     , keys = Objects.keys(localStorage), i = keys.length;
                                //     while (i--) {values.push(localStorage.getItem(keys[i]) ); }
                                //     var aside = document.getElementsByTagName('aside');
                                    
                                //    console.log(values)
                                // }

                                console.log(data.meals[0]);
                                let recipeTitle = data.meals[0].strMeal;                         
                                
                            
                                function updateAside(){
                                    var values = [], keys = Objects.keys(localStorage), i = keys.length;
                                    while (i--) {values.push(localStorage.getItem(keys[i]) ); }
                                    var aside = document.getElementsByTagName('aside');
                                
                                    let favList = "";
                                    favList+=`
                                    <div id="favBox">
                                    `
                            }

                            
                        });
                })
       
            }
   
        }).catch(()=>
                    results.innerHTML=`<h3>Invalid Input</h3>`)

            

                }
            
                  

            
            })
            
            //COMMENT FUNCTION               
            var commentBtn= document.getElementById("commentBtn");
                commentBtn.addEventListener("click", function(){
                var commentBoxValue= document.getElementById("commentInp").value; 
                var p = document.createElement("p");
                var text = document.createTextNode(commentBoxValue);
                p.appendChild(text);
                document.getElementById("comments").appendChild(p);               



            })


            
            
         
    </script>
</body>
</html>